!function(e){if("function"==typeof bootstrap)bootstrap("promise",e);else if("object"==typeof exports)module.exports=e();else if("function"==typeof define&&define.amd)define(e);else if("undefined"!=typeof ses){if(!ses.ok())return;ses.makeVPpubsub=e}else window.VPpubsub=e()}(function(){"use strict";function e(e,n){if(e.indexOf)return e.indexOf(n);for(var t=0,o=e.length;o>t;t++)if(e[t]===n)return t;return-1}function n(e){return"function"==typeof e}function t(){var s,f={},r={};return s={pub:function(n,t,o,s){function a(n){var i;r[n]||(r[n]={scopes:[],data:[]}),i=e(r[n].scopes,o),~i||(i=r[n].scopes.push(o)-1),r[n].data[i]=t}function c(e,n,t,o){u(function(){e.$$VPpubsubRemoved!==o&&e.call(n,t,o,e)})}var p="",l=[],d=n;if(i.test(n)){f[n]&&(l=l.concat(f[n])),n=n.split("@")[0],n!==d&&f[n]&&(l=l.concat(f[n])),a(n),f[n+".*"]&&(l=l.concat(f[n+".*"])),n=n.split("."),p=n[0];for(var b=1,v=n.length;v>b;b++)f[p+".*"]&&(l=l.concat(f[p+".*"])),p+="."+n[b];f["*"]&&(l=l.concat(f["*"]));for(var m=0,z=l.length;z>m;m++)l[m][1]&&l[m][1]!==o||(s?l[m][0].call(l[m][2],t,d,l[m][0]):c(l[m][0],l[m][2],t,d))}},sub:function(t,i,u,s){function a(n,t){var o=-1,i=n;if(~n.indexOf("*")){n=new RegExp("^"+n.substr(0,n.length-2).replace(".","\\.")+"(?![a-zA-Z0-9])");for(i in r)if(n.test(i)){o=e(r[i].scopes,u);break}}else r[n]&&(o=e(r[n].scopes,u));~o&&t.call(s,r[i].data[o],i,t)}var c,p,l,d=t.split("|");if(n(i))for(var b=0,v=d.length;v>b;b++)c=d[b],l=!1,o.test(d[b])&&("!"===c.slice(0,1)&&(c=c.slice(1),l=!0),f[c]||(f[c]=[]),delete i.$$VPpubsubRemoved,p=f[c].push([i,u,s]),l&&a(c,f[c][p-1][0]))},subonce:function(e,t,o,i){n(t)&&(~e.indexOf("*")||s.sub(e,function(e,n,u){s.unsub(n,u,o),t.call(i,e,n,t)},o,i))},unsub:function(e,t,o){var i=f[e]||[];if(n(t))for(var u=0,s=i.length;s>u;u++)i[u][0]!==t||i[u][1]&&i[u][1]!==o||(t.$$VPpubsubRemoved=e,i.splice(u,1),u--,s--)},fork:function(){return t()}}}var o=/^!?(\*$|[a-z])([a-z0-9]*)(\.([a-z0-9]+|\*$))*(@[0-9a-z]+)?$/,i=/^[a-z]([a-z0-9]*)(\.[a-z0-9]+)*(@[0-9a-z]+)?$/,u=function(){var e="undefined"==typeof window?process:window,n=e.requestAnimationFrame||e.webkitRequestAnimationFrame||e.mozRequestAnimationFrame||e.nextTick;return n?n:function(e){setTimeout(e,1e3/60)}}();return t()});
//# sourceMappingURL=vp-pubsub.js.map
