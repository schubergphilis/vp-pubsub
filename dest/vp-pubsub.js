!function(n){if("function"==typeof bootstrap)bootstrap("promise",n);else if("object"==typeof exports)module.exports=n();else if("function"==typeof define&&define.amd)define(n);else if("undefined"!=typeof ses){if(!ses.ok())return;ses.makeVPpubsub=n}else window.VPpubsub=n()}(function(){"use strict";function n(n,e){if(n.indexOf)return n.indexOf(e);for(var t=0,o=n.length;o>t;t++)if(n[t]===e)return t;return-1}function e(n){return"function"==typeof n}function t(){var f,r={},s={};return f={pub:function(e,t,o,f){function c(e){var u;s[e]||(s[e]={scopes:[],data:[]}),u=n(s[e].scopes,o),~u||(u=s[e].scopes.push(o)-1),s[e].data[u]=t}function a(n,e,t,o){i(function(){n.$$VPpubsubRemoved!==o&&n.call(e,t,o,n)})}var p="",l=[],b=e;if(u.test(e)){r[e]&&(l=l.concat(r[e])),e=e.split("@")[0],e!==b&&r[e]&&(l=l.concat(r[e])),c(e),r[e+".*"]&&(l=l.concat(r[e+".*"])),e=e.split("."),p=e[0];for(var d=1,v=e.length;v>d;d++)r[p+".*"]&&(l=l.concat(r[p+".*"])),p+="."+e[d];r["*"]&&(l=l.concat(r["*"]));for(var m=0,h=l.length;h>m;m++)l[m][1]&&l[m][1]!==o||(f?l[m][0].call(l[m][2],t,b,l[m][0]):a(l[m][0],l[m][2],t,b))}},sub:function(t,u,i,f){function c(e,t){var o=-1,u=e;if(~e.indexOf("*")){e=new RegExp("^"+e.substr(0,e.length-2).replace(".","\\.")+"(?![a-zA-Z0-9])");for(u in s)if(e.test(u)){o=n(s[u].scopes,i);break}}else s[e]&&(o=n(s[e].scopes,i));~o&&t.call(f,s[u].data[o],u,t)}var a,p,l,b=t.split("|");if(e(u))for(var d=0,v=b.length;v>d;d++)a=b[d],l=!1,o.test(b[d])&&("!"===a.slice(0,1)&&(a=a.slice(1),l=!0),r[a]||(r[a]=[]),delete u.$$VPpubsubRemoved,p=r[a].push([u,i,f]),l&&c(a,r[a][p-1][0]))},subonce:function(n,t,o,u){e(t)&&(~n.indexOf("*")||f.sub(n,function(n,e,i){f.unsub(e,i,o),t.call(u,n,e,t)},o,u))},on:function(n,t,o){function u(){f.unsub(n,r,t,o)}function i(){var n=p.length;if((!c||!a)&&n&&s){for(var e=0;n>e;e++)p[e].apply(o,s);c=!0,a&&u()}}function r(n,e,t){s=[n,e,t],i()}var s,c,a,p=[];return f.sub(n,r,t,o),{off:u,then:function(n){return e(n)&&p.push(n),i(),{off:function(){a=!0,c&&u()}}}}},unsub:function(n,t,o){var u=r[n]||[];if(e(t))for(var i=0,f=u.length;f>i;i++)u[i][0]!==t||u[i][1]&&u[i][1]!==o||(t.$$VPpubsubRemoved=n,u.splice(i,1),i--,f--)},fork:function(){return t()}}}var o=/^!?(\*$|[a-z])([a-z0-9]*)(\.([a-z0-9]+|\*$))*(@[0-9a-z]+)?$/,u=/^[a-z]([a-z0-9]*)(\.[a-z0-9]+)*(@[0-9a-z]+)?$/,i=function(){var n="undefined"==typeof window?process:window,e=n.requestAnimationFrame||n.webkitRequestAnimationFrame||n.mozRequestAnimationFrame||n.nextTick;return e?e:function(n){setTimeout(n,1e3/60)}}();return t()});
//# sourceMappingURL=vp-pubsub.js.map
